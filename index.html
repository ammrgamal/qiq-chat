<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QuickITQuote Chat</title>

  <!-- Styles -->
  <link rel="stylesheet" href="/public/css/styles.css" />

  <!-- Vendor (XLSX ููุท ููู BOQ) -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" defer></script>
</head>
<body>
  <!-- ======== Chat ======== -->
  <section id="qiq-chat" class="qiq">
    <div class="qiq-window" id="qiq-window" aria-live="polite"></div>

    <form id="qiq-form" class="qiq-form" autocomplete="off">
      <input id="qiq-input" class="qiq-input" type="text"
             placeholder="ุงูุชุจ ุณุคุงูู ุฃู ุงุจุฏุฃ.. ูุซูุง: ุนุงูุฒ Kaspersky EDR ูู 120 ูุณุชุฎุฏู ููุฏุฉ ุณูุชูู" required />
      <div class="qiq-actions">
        <button class="qiq-btn qiq-primary" type="button" id="qiq-import-btn" title="ุงุณุชูุฑุงุฏ BOQ (Excel)">Import BOQ (Excel)</button>
        <button class="qiq-send" type="submit">ุฅุฑุณุงู</button>
        <input type="file" id="qiq-file" accept=".xlsx,.xls,.csv" hidden />
      </div>
    </form>
  </section>

  <!-- ======== Product Results ======== -->
  <div id="qiq-products-list" class="qiq-products-list"></div>

  <!-- ======== BOQ / Staging ======== -->
  <section id="qiq-boq-wrap" class="qiq-boq">
    <div class="qiq-boq-top">
      <button id="qiq-add-all" class="qiq-btn qiq-success" type="button" disabled>ุฅุถุงูุฉ ุงููู ููุนุฑุถ</button>
      <div class="qiq-right">
        <button id="qiq-save-draft" class="qiq-btn qiq-primary" type="button">ุญูุธ ููุณูุฏุฉ</button>
        <button id="qiq-load-draft" class="qiq-btn" type="button">ุชุญููู ูุณูุฏุฉ</button>
        <button id="qiq-show-log" class="qiq-btn" type="button">ุฅุธูุงุฑ ุงูุณุฌู</button>
        <button id="qiq-clear-all" class="qiq-btn" type="button" style="background:#dc2626">ูุณุญ ุงููู</button>
        <button id="qiq-export-csv"  class="qiq-btn" type="button">ุชุตุฏูุฑ CSV</button>
        <button id="qiq-export-xlsx" class="qiq-btn" type="button">ุชุตุฏูุฑ XLSX</button>
        <span id="qiq-status" class="qiq-status"></span>
      </div>
    </div>
    
    <!-- Search/Filter for products -->
    <div class="qiq-search">
      <span class="qiq-search-icon">๐</span>
      <input 
        id="qiq-search-input" 
        class="qiq-search-input" 
        type="text" 
        placeholder="ุงูุจุญุซ ูู ุงูููุชุฌุงุช (ุงูุงุณู ุฃู ุงูููุฏ)..." 
        autocomplete="off"
      />
      <span id="qiq-search-count" class="qiq-status"></span>
    </div>
    
    <div class="qiq-table-wrap">
      <table class="qiq-table" aria-label="Staged items">
        <thead>
          <tr>
<th style="width:40%">ุงููุตู / ุฑูู ุงูููุชุฌ / SKU</th>
<th style="width:10%">ุงูุณุนุฑ ูููุญุฏุฉ</th>
<th style="width:10%">ุงูุฅุฌูุงูู</th>
<th style="width:10%">ุงูุฅุฌุฑุงุกุงุช</th>
<th style="width:10%">ุตูุฑุฉ</th>
          </tr>
        </thead>
        <tbody id="qiq-body"></tbody>
        <tfoot>
          <tr>
            <td colspan="5" style="text-align:left"><strong>ุงูุฅุฌูุงูู ุงูููู:</strong></td>
            <td id="qiq-grand" colspan="2"><strong>-</strong></td>
          </tr>
        </tfoot>
      </table>
    </div>

    <!-- Operations Log -->
    <div class="qiq-log-section" id="qiq-log-section" style="margin-top: 16px; display: none;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
        <h3 style="margin: 0; font-size: 14px; color: #374151;">ุณุฌู ุงูุนูููุงุช</h3>
        <div>
          <button id="qiq-toggle-log" class="qiq-btn" type="button" style="font-size: 12px; padding: 4px 8px;">ุฅุฎูุงุก</button>
          <button id="qiq-clear-log" class="qiq-btn" type="button" style="font-size: 12px; padding: 4px 8px; background: #dc2626;">ูุณุญ ุงูุณุฌู</button>
        </div>
      </div>
      <div id="qiq-log-content" class="qiq-log-content" style="max-height: 150px; overflow-y: auto; background: #f8fafc; border: 1px solid #e5e7eb; border-radius: 8px; padding: 8px; font-size: 12px;">
        <!-- Log entries will be added here -->
      </div>
    </div>
  </section>

  <!-- ======== Custom Quotation (ุทูุจ ุนุฑุถ ุณุนุฑ ูุฎุตูุต) ======== -->
  <section id="qiq-quote" class="qiq-card" aria-labelledby="quote-title">
    <h2 id="quote-title">ุทูุจ ุนุฑุถ ุณุนุฑ ูุฎุตูุต</h2>
    <form id="quote-form" class="qiq-form-vertical" autocomplete="off">
      <div class="row">
        <label>ุงุณู ุงูุดุฑูุฉ</label>
        <input type="text" name="company" required />
      </div>
      <div class="row">
        <label>ูุฌุงู ุงููุดุงุท</label>
        <input type="text" name="industry" />
      </div>
      <div class="row">
        <label>ุนุฏุฏ ุงููุณุชุฎุฏููู</label>
        <input type="number" name="users" min="1" required />
      </div>
      <div class="row">
        <label>ุงูุฃููููุฉ</label>
        <select name="priority">
          <option value="Security">Security</option>
          <option value="Cloud">Cloud</option>
          <option value="Collaboration">Collaboration</option>
          <option value="Network">Network</option>
        </select>
      </div>
      <div class="row">
        <label>ุงูููุฒุงููุฉ ุงูุชูุฑูุจูุฉ (USD)</label>
        <input type="number" name="budget_usd" min="0" />
      </div>
      <div class="row">
        <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
        <input type="email" name="email" required />
      </div>
      <div class="row">
        <label>ุฑูู ุงูููุจุงูู</label>
        <input type="tel" name="phone" required />
      </div>
      <div class="row">
        <label>ุชูุงุตูู ุฅุถุงููุฉ</label>
        <textarea name="notes" rows="3" placeholder="ุงุฐูุฑ ุงูููุชุฌุงุช ุฃู ุงูููุงุตูุงุช ุงููุทููุจุฉโฆ"></textarea>
      </div>

      <div class="row actions">
        <button type="submit" class="qiq-btn qiq-primary">ุฅุฑุณุงู ุงูุทูุจ</button>
        <span id="quote-status" class="qiq-status"></span>
      </div>
    </form>
  </section>

  <!-- ======== ุญุณุงุจ ุงููุณุชุฎุฏู (ุชุณุฌูู/ุฏุฎูู) ======== -->
  <section id="qiq-account" class="qiq-card">
    <h2>ุงูุญุณุงุจ</h2>
    <div class="account-actions">
      <button id="btn-login" class="qiq-btn">ุชุณุฌูู ุงูุฏุฎูู</button>
      <button id="btn-register" class="qiq-btn qiq-primary">ุฅูุดุงุก ุญุณุงุจ</button>
      <button id="btn-logout" class="qiq-btn qiq-danger" hidden>ุชุณุฌูู ุงูุฎุฑูุฌ</button>
      <span id="account-status" class="qiq-status"></span>
    </div>
  </section>

  <!-- ======== Modal ุชูุงุตูู ููุชุฌ ======== -->
  <div id="qiq-modal" class="qiq-modal" aria-hidden="true" role="dialog" aria-label="ุชูุงุตูู ุงูููุชุฌ">
    <div class="qiq-modal__backdrop"></div>
    <div class="qiq-modal__dialog">
      <button class="qiq-modal__close" aria-label="ุฅุบูุงู" type="button">ร</button>
      <iframe id="qiq-modal-frame" src="" loading="lazy"></iframe>
    </div>
  </div>

  <!-- ======== Toast Notifications Container ======== -->
  <div id="qiq-toast-container" class="qiq-toast" aria-live="polite"></div>

  <!-- ======== Bundles (Front-end) ======== -->
  <!-- toast.js: ูุธุงู ุงูุฅุดุนุงุฑุงุช ุงููุญุณู -->
  <script src="/public/js/toast.js"></script>
  <!-- api.js: ุฏูุงู ุงููetch ููุจุงู ุฅูุฏ (/api/search, /api/chat, /api/quote, /api/users/...) -->
  <script src="/public/js/api.js"></script>
  <!-- quote-actions.js: BOQ table functionality and AddToQuote function -->
  <script src="/public/js/quote-actions.js"></script>
  <!-- ui-chat.js: ูุงุฌูุฉ ุงูุดุงุช + ุงูBOQ + ุงูููุทู ุงูุฐูู ููุจุญุซ ุนุจุฑ /api/search -->
  <script src="/public/js/ui-chat.js"></script>
  <!-- quote-form.js: ุฅุฑุณุงู ููุฑู ุงูุนุฑุถ ุงููุฎุตุต ุฅูู /api/quote -->
  <script src="/public/js/quote-form.js"></script>
  <!-- account.js: ุชุณุฌูู/ุฏุฎูู/ุฎุฑูุฌ (JWT) ุนุจุฑ /api/users/... -->
  <script src="/public/js/account.js"></script>

  <!-- ููุงุญุธุฉ: ุทุงููุง ุจูุณุชุฎุฏู /api/search ุนูู ุงูุณูุฑูุฑุ ูุด ูุญุชุงุฌูู Algolia keys ูู ุงููุฑููุช ุฅุทูุงููุง -->
</body>
</html>
